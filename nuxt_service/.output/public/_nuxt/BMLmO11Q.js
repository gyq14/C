import{d as I,a9 as q,r as _,a0 as B,o as p,b as v,e as s,j as l,g as u,t as b,f as t,w as o,h as y,F as U,a8 as $,a7 as N,_ as T}from"./BKjTAV26.js";import{E as c}from"./go3Pwg4k.js";import{a as j,E as g}from"./BkrI6Yra.js";import{E as M}from"./CfeOwlTK.js";import{E as A}from"./e_7zQVqF.js";import{a as E,E as f}from"./BsR5JkuZ.js";import{E as O}from"./D646KoZa.js";import"./Lm5XNi9w.js";import"./CiLdZ0ri.js";import"./i6Tmy0Ys.js";import"./B_jPntpX.js";import"./DqWkRQbi.js";import"./D00d6A06.js";import"./D1ZkmWoV.js";import"./A8IlQKut.js";import"./CSNTPWt0.js";const P={class:"task-container"},R={class:"task-info"},Y={key:0},z={key:0},G={key:1},H={key:1},J={class:"task-subtasks"},K={class:"subtasks-header"},L={slot:"footer",class:"dialog-footer"},Q=I({__name:"[id]",setup(W){const V={1:{id:1,name:"任务 1",status:"待处理",deadline:"2024-12-31",time:"14:00",responsible:["张三","李四"],description:"任务描述内容",attachments:["文件1.pdf","文件2.pdf"],user_id:101,platform_type:"内网",subtasks:[{id:1,name:"子任务 1",status:"待处理",deadline:"2024-12-31",responsible:["张三"]},{id:2,name:"子任务 2",status:"已完成",deadline:"2024-11-15",responsible:["李四"]}]},2:{id:2,name:"任务 2",status:"已完成",deadline:"2024-11-15",time:"10:00",responsible:["王五"],description:"任务描述内容",attachments:[],user_id:102,platform_type:"供应商",subtasks:[{id:3,name:"子任务 3",status:"待处理",deadline:"2024-12-31",responsible:["王五"]}]}},S=q().params.id,n=V[S]??null,k=_((n==null?void 0:n.subtasks)??[]),m=_(!1),a=_({name:"",status:"待处理",deadline:"",responsible:[]}),w=d=>{if(typeof d=="string")return d;const e=new Date(d),i=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),x=String(e.getDate()).padStart(2,"0");return`${i}-${r}-${x}`},C=()=>{m.value=!0},D=()=>{if(a.value.name&&a.value.responsible.length&&a.value.deadline){a.value.deadline=w(a.value.deadline);const d=k.value.length+1;k.value.push({...a.value,id:d}),m.value=!1,a.value={name:"",status:"待处理",deadline:"",responsible:[]}}else alert("请填写完整的子任务信息")},F=()=>{a.value={name:"",status:"待处理",deadline:"",responsible:[]},m.value=!1};return B(()=>{n||console.error("任务未找到")}),(d,e)=>{const i=N;return p(),v(U,null,[s("div",P,[s("div",R,[e[12]||(e[12]=s("h2",null,"任务基本信息",-1)),l(n)?(p(),v("div",Y,[s("div",null,[e[5]||(e[5]=s("strong",null,"任务名称:",-1)),u(" "+b(l(n).name),1)]),s("div",null,[e[6]||(e[6]=s("strong",null,"任务状态:",-1)),u(" "+b(l(n).status),1)]),s("div",null,[e[7]||(e[7]=s("strong",null,"截止时间:",-1)),u(" "+b(l(n).deadline),1)]),s("div",null,[e[8]||(e[8]=s("strong",null,"负责人:",-1)),u(" "+b(l(n).responsible.join(", ")),1)]),s("div",null,[e[9]||(e[9]=s("strong",null,"描述:",-1)),u(" "+b(l(n).description||"无描述"),1)]),s("div",null,[e[10]||(e[10]=s("strong",null,"附件:",-1)),e[11]||(e[11]=u()),l(n).attachments?(p(),v("span",z,"有附件")):(p(),v("span",G,"无附件"))])])):(p(),v("div",H,[t(l(c),{title:"任务未找到",type:"error"})]))]),s("div",J,[s("div",K,[e[14]||(e[14]=s("div",null,[s("h2",null,"子任务列表")],-1)),s("div",null,[t(l(y),{type:"primary",icon:"el-icon-plus",style:{},onClick:C},{default:o(()=>e[13]||(e[13]=[u("新建")])),_:1})])]),t(l(j),{data:k.value,style:{width:"100%"},border:""},{default:o(()=>[t(l(g),{prop:"name",label:"子任务名称"}),t(l(g),{prop:"status",label:"子任务状态"}),t(l(g),{prop:"deadline",label:"子任务截止时间"}),t(l(g),{prop:"responsible",label:"子任务负责人"})]),_:1},8,["data"])])]),t(l(M),{"model-value":m.value,title:"新建子任务",width:"50%",onClose:F},{default:o(()=>[t(l($),{model:a.value,ref:"subtaskForm","label-width":"120px"},{default:o(()=>[t(i,{label:"子任务名称",rules:[{required:!0,message:"请输入子任务名称",trigger:"blur"}]},{default:o(()=>[t(l(A),{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=r=>a.value.name=r),placeholder:"请输入子任务名称"},null,8,["modelValue"])]),_:1}),t(i,{label:"子任务状态",rules:[{required:!0,message:"请选择子任务状态",trigger:"change"}]},{default:o(()=>[t(l(E),{modelValue:a.value.status,"onUpdate:modelValue":e[1]||(e[1]=r=>a.value.status=r),placeholder:"请选择子任务状态"},{default:o(()=>[t(l(f),{label:"待处理",value:"待处理"}),t(l(f),{label:"已完成",value:"已完成"})]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"子任务截止时间",rules:[{required:!0,message:"请选择截止时间",trigger:"change"}]},{default:o(()=>[t(l(O),{modelValue:a.value.deadline,"onUpdate:modelValue":e[2]||(e[2]=r=>a.value.deadline=r),type:"date",placeholder:"请选择截止时间"},null,8,["modelValue"])]),_:1}),t(i,{label:"子任务负责人",rules:[{required:!0,message:"请选择子任务负责人",trigger:"change"}]},{default:o(()=>[t(l(E),{modelValue:a.value.responsible,"onUpdate:modelValue":e[3]||(e[3]=r=>a.value.responsible=r),placeholder:"请选择负责人",multiple:""},{default:o(()=>[t(l(f),{label:"张三",value:"张三"}),t(l(f),{label:"李四",value:"李四"}),t(l(f),{label:"王五",value:"王五"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),s("div",L,[t(l(y),{onClick:e[4]||(e[4]=r=>m.value=!1)},{default:o(()=>e[15]||(e[15]=[u("取消")])),_:1}),t(l(y),{type:"primary",onClick:D},{default:o(()=>e[16]||(e[16]=[u("创建")])),_:1})])]),_:1},8,["model-value"])],64)}}}),be=T(Q,[["__scopeId","data-v-2fb3c829"]]);export{be as default};
