import{d as Y,r as u,u as G,a9 as H,aa as J,i as K,a0 as W,o as m,b as f,e as n,f as a,w as o,j as b,s as X,t as _,h as Z,g as i,F as V,Y as w,c as ee,ab as te,a7 as le,E as ae,M as oe,a8 as se,_ as ne}from"./BKjTAV26.js";import{E as re}from"./e_7zQVqF.js";import{E as ue,a as ie}from"./D646KoZa.js";import{E as de,a as pe}from"./Kf5dBhzp.js";import{E as me,a as ce}from"./BsR5JkuZ.js";import{E as fe}from"./CfeOwlTK.js";import{E as _e}from"./CSNTPWt0.js";import{E as ve}from"./DY1Al2b1.js";import{E as ge}from"./BFF8ropv.js";import{z as ye}from"./z0oBgxIm.js";import{u as be}from"./CNJuuRFD.js";import{u as ke}from"./BW5v7ni-.js";import{u as Ee}from"./Bx7TRS-Q.js";import"./CiLdZ0ri.js";import"./Lm5XNi9w.js";import"./B_jPntpX.js";import"./DqWkRQbi.js";import"./i6Tmy0Ys.js";import"./D1ZkmWoV.js";import"./A8IlQKut.js";const Ve={style:{display:"flex","align-items":"center","margin-bottom":"20px"}},we={style:{"margin-left":"20px"}},xe={style:{display:"flex"}},Te={class:"dialog-footer"},Ce=["onDblclick"],De={class:"card-header"},Ie={class:"card-content"},Se=Y({__name:"TaskCenter",setup(Ue){const x=u(ye),c=G(),v=be(),T=ke(),C=Ee();H();const D=J(),l=u({name:"",deadline:"",time:"",responsible:0,desc:""}),d=u(!1);u(!1);const I=()=>{var s,e,r;l.value.name&&l.value.responsible>0&&(v.createTask({title:l.value.name,version:"A.1",approverId:l.value.responsible,responsibleId:(s=c.userData)==null?void 0:s.id,dueDate:"23432523545",description:l.value.desc}),d.value=!1,T.createNotification({title:`${l.value.name}的审批通知`,type:"Information",status:"Unread",senderId:(e=c.userData)==null?void 0:e.id,receiverId:l.value.responsible,expiry:"23423545"}),C.createTodo({title:l.value.name,type:"Task",status:"AwaitingApproval",applicantId:(r=c.userData)==null?void 0:r.id,receiverId:l.value.responsible}),k())},k=()=>{l.value.name="",l.value.deadline="",l.value.time="",l.value.responsible=0,l.value.desc=""},E=K(()=>v.unCompletedtasksData.filter(s=>s.title.includes(g.value))),S=u(0),g=u("");W(()=>{S.value=v.unCompletedtasksData.length});const U=s=>{D.push(`/admin/TaskCenter-TaskCenter/${s}`)},A=s=>{switch(s){case"InProgress":return"success";case"Pending":return"primary";case"AwaitingApproval":return"warning";case"Delayed":return"warning";case"Completed":return"info";default:return"default"}},P=s=>{switch(s){case"InProgress":return"进行中";case"AwaitingApproval":return"待审批";case"Completed":return"已完成";case"Pending":return"待处理";case"Delayed":return"已延期";default:return"未知状态"}};return(s,e)=>{const r=Z,y=re,p=le,N=ue,B=ie,F=de,$=ae,h=me,q=ce,R=oe,j=pe,z=se,M=fe,L=_e,O=ve,Q=ge;return m(),f("div",null,[n("div",Ve,[a(r,{type:"primary",onClick:e[0]||(e[0]=t=>d.value=!0)},{default:o(()=>e[9]||(e[9]=[i("新建")])),_:1}),a(y,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=t=>g.value=t),"suffix-icon":b(X),placeholder:"搜索任务",clearable:"",style:{width:"300px","margin-left":"10px"}},null,8,["modelValue","suffix-icon"]),n("div",we,"合计 "+_(E.value.length)+" 条",1)]),a(M,{modelValue:d.value,"onUpdate:modelValue":e[8]||(e[8]=t=>d.value=t),title:"新建任务",width:"800px",center:!0,onClose:k},{footer:o(()=>[n("span",Te,[a(r,{onClick:e[7]||(e[7]=t=>d.value=!1)},{default:o(()=>e[12]||(e[12]=[i("取消")])),_:1}),a(r,{type:"primary",onClick:I},{default:o(()=>e[13]||(e[13]=[i("确定")])),_:1})])]),default:o(()=>[a(z,{model:l.value,"label-width":"auto",style:{"max-width":"100%",padding:"20px"}},{default:o(()=>[a(p,{label:"任务名称：",required:""},{default:o(()=>[a(y,{modelValue:l.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.name=t),placeholder:"请输入任务名称"},null,8,["modelValue"])]),_:1}),a($,{locale:x.value},{default:o(()=>[a(p,{label:"截止时间：",required:""},{default:o(()=>[a(F,null,{default:o(()=>[n("div",xe,[a(N,{modelValue:l.value.deadline,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.deadline=t),type:"date",placeholder:"选择截止时间",style:{width:"305px"}},null,8,["modelValue"]),e[10]||(e[10]=i(" ---- ")),a(B,{modelValue:l.value.time,"onUpdate:modelValue":e[4]||(e[4]=t=>l.value.time=t),placeholder:"选择时间",style:{width:"305px"}},null,8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["locale"]),a(p,{label:"负责人：",required:""},{default:o(()=>[a(q,{modelValue:l.value.responsible,"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.responsible=t),placeholder:"请选择负责人"},{default:o(()=>[(m(!0),f(V,null,w(b(c).leaderData,t=>(m(),ee(h,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"备注："},{default:o(()=>[a(y,{modelValue:l.value.desc,"onUpdate:modelValue":e[6]||(e[6]=t=>l.value.desc=t),type:"textarea",placeholder:"请输入备注说明"},null,8,["modelValue"])]),_:1}),a(p,{label:"附件："},{default:o(()=>[a(j,{class:"upload-demo",drag:"",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15",multiple:"",style:{width:"100%"}},{default:o(()=>[a(R,{class:"el-icon--upload"},{default:o(()=>[a(b(te))]),_:1}),e[11]||(e[11]=n("div",null,"上传文件",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(Q,{wrap:""},{default:o(()=>[(m(!0),f(V,null,w(E.value,t=>(m(),f("div",{key:t.title,class:"custom-card",onDblclick:Ae=>t.status!="AwaitingApproval"&&U(t.id)},[n("span",De,[n("div",null,_(t.title),1),a(L,{type:A(t.status),effect:"dark"},{default:o(()=>[i(_(P(t.status)),1)]),_:2},1032,["type"])]),a(O,{style:{margin:"5px 0"}}),n("div",Ie,[e[14]||(e[14]=n("strong",null,"备注:",-1)),i(" "+_(t.description),1)])],40,Ce))),128))]),_:1})])}}}),Xe=ne(Se,[["__scopeId","data-v-392313ce"]]);export{Xe as default};
