import{E as M}from"./go3Pwg4k.js";import{d as w,u as h,a9 as j,aa as O,r as v,a0 as Y,o as p,b as m,e as o,g as a,t as f,f as t,w as s,F as z,h as G,a7 as H,a8 as J,_ as K,k as L,j as Q,l as W}from"./BKjTAV26.js";import{a as X,E as Z}from"./BkrI6Yra.js";import{E as ee}from"./e_7zQVqF.js";import{E as te}from"./D646KoZa.js";import{E as oe,a as le}from"./BsR5JkuZ.js";import{E as se}from"./CfeOwlTK.js";import{u as ae}from"./CNJuuRFD.js";import{u as ne}from"./DpdxWg4J.js";import"./Lm5XNi9w.js";import"./CiLdZ0ri.js";import"./i6Tmy0Ys.js";import"./B_jPntpX.js";import"./DqWkRQbi.js";import"./D00d6A06.js";import"./CSNTPWt0.js";import"./D1ZkmWoV.js";import"./A8IlQKut.js";const re={class:"task-container"},ue={class:"task-info"},ie={key:0},de={key:0},pe={key:1},me={key:1},_e={class:"task-subtasks"},ve={class:"subtasks-header"},fe={slot:"footer",class:"dialog-footer"},ce=w({__name:"alltask",props:{routetype:{}},setup(E){h();const c=ae();ne();const S=E,V=j(),g=O(),x=Number(V.params.id),u=v(c.getTaskById(x)),b=v([]),_=v(!1),l=v({name:"",status:"待处理",deadline:"",responsible:[]}),$=n=>{if(typeof n=="string")return n;const e=new Date(n),k=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${k}-${r}-${i}`},D=()=>{_.value=!0},F=()=>{if(l.value.name&&l.value.responsible.length&&l.value.deadline){l.value.deadline=$(l.value.deadline);const n=b.value.length+1;b.value.push({...l.value,id:n}),_.value=!1,l.value={name:"",status:"待处理",deadline:"",responsible:[]}}else alert("请填写完整的子任务信息")},I=()=>{l.value={name:"",status:"待处理",deadline:"",responsible:[]},_.value=!1};function C(){g.push(`${S.routetype}`)}const B=n=>{switch(n){case"InProgress":return"进行中";case"AwaitingApproval":return"待审批";case"Completed":return"已完成";case"Pending":return"待处理";default:return"未知状态"}};return Y(()=>{u||console.error("任务未找到")}),(n,e)=>{const k=M,r=G,i=Z,T=X,N=ee,y=H,A=te,U=oe,q=le,P=J,R=se;return p(),m(z,null,[o("div",re,[o("div",ue,[e[10]||(e[10]=o("h2",null,"任务基本信息",-1)),u.value?(p(),m("div",ie,[o("div",null,[e[4]||(e[4]=o("strong",null,"任务名称:",-1)),a(" "+f(u.value.title),1)]),o("div",null,[e[5]||(e[5]=o("strong",null,"任务状态:",-1)),a(" "+f(B(u.value.status)),1)]),e[9]||(e[9]=o("div",null,[o("strong",null,"截止时间:"),a(" "+f("2024.12.31"))],-1)),o("div",null,[e[6]||(e[6]=o("strong",null,"描述:",-1)),a(" "+f(u.value.description||"无描述"),1)]),o("div",null,[e[7]||(e[7]=o("strong",null,"附件:",-1)),e[8]||(e[8]=a()),u.value.attachments?(p(),m("span",de,"有附件")):(p(),m("span",pe,"无附件"))])])):(p(),m("div",me,[t(k,{title:"任务未找到",type:"error"})]))]),o("div",_e,[o("div",ve,[e[12]||(e[12]=o("div",null,[o("h2",null,"子任务列表")],-1)),o("div",null,[t(r,{type:"primary",onClick:D},{default:s(()=>e[11]||(e[11]=[a("新建子任务")])),_:1})])]),t(T,{data:b.value,style:{width:"100%",height:"90%"},border:""},{default:s(()=>[t(i,{prop:"name",label:"子任务名称"}),t(i,{prop:"status",label:"子任务状态"}),t(i,{prop:"deadline",label:"子任务截止时间"}),t(i,{prop:"responsible",label:"子任务供应商"})]),_:1},8,["data"]),t(r,{onClick:C},{default:s(()=>e[13]||(e[13]=[a("取消")])),_:1}),t(r,{type:"primary",onClick:C},{default:s(()=>e[14]||(e[14]=[a("确定")])),_:1})])]),t(R,{"model-value":_.value,title:"新建子任务",width:"50%",onClose:I},{default:s(()=>[t(P,{model:l.value,ref:"subtaskForm","label-width":"120px",style:{"padding-top":"20px"}},{default:s(()=>[t(y,{label:"名称",rules:[{required:!0,message:"请输入子任务名称",trigger:"blur"}]},{default:s(()=>[t(N,{modelValue:l.value.name,"onUpdate:modelValue":e[0]||(e[0]=d=>l.value.name=d),placeholder:"请输入子任务名称"},null,8,["modelValue"])]),_:1}),t(y,{label:"截止时间",rules:[{required:!0,message:"请选择截止时间",trigger:"change"}]},{default:s(()=>[t(A,{modelValue:l.value.deadline,"onUpdate:modelValue":e[1]||(e[1]=d=>l.value.deadline=d),type:"date",placeholder:"请选择截止时间"},null,8,["modelValue"])]),_:1}),t(y,{label:"供应商",rules:[{required:!0,message:"请选择供应商",trigger:"change"}]},{default:s(()=>[t(q,{modelValue:l.value.responsible,"onUpdate:modelValue":e[2]||(e[2]=d=>l.value.responsible=d),placeholder:"请选择供应商",multiple:""},{default:s(()=>[t(U,{label:"中车戚墅堰机车车辆工艺研究所股份有限公司",value:"中车戚墅堰机车车辆工艺研究所股份有限公司"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),o("div",fe,[t(r,{onClick:e[3]||(e[3]=d=>_.value=!1)},{default:s(()=>e[15]||(e[15]=[a("取消")])),_:1}),t(r,{type:"primary",onClick:F},{default:s(()=>e[16]||(e[16]=[a("创建")])),_:1})])]),_:1},8,["model-value"])],64)}}}),ge=K(ce,[["__scopeId","data-v-23f36ce1"]]),be={key:0},ke="/admin/TaskCenter",Re=w({__name:"[id]",setup(E){const c=L();return(S,V)=>{const g=ge;return Q(c).params.id?(p(),m("div",be,[t(g,{routetype:ke})])):W("",!0)}}});export{Re as default};
