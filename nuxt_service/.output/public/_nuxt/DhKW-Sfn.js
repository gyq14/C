import{d as N,a9 as U,aa as L,r as p,a0 as E,o as n,b as a,e,t as l,V as F,g as b,F as k,Y as w,l as g,_ as M,u as Y,S as P,dS as R}from"./BKjTAV26.js";import{u as q}from"./Bx7TRS-Q.js";import{u as G,S as V}from"./DpdxWg4J.js";const H={class:"max-w-4xl mx-auto bg-white p-6 rounded-lg shadow-md mt-10"},J={key:0,class:"flex justify-center items-center py-4"},K={key:1},O={class:"flex justify-between items-center mb-4 border-b pb-4"},Q={class:"text-2xl font-semibold"},W={class:"mb-4"},X={class:"mb-4"},Z={class:"text-gray-700 mt-2"},ee={class:"mb-4"},te={class:"break-words"},se={class:"mb-4"},oe={key:0,class:"mb-4"},ne={class:"list-disc ml-5 mt-2 text-blue-600"},ae=["onClick"],le={key:1,class:"flex justify-between items-center mt-4 mb-4"},ue=N({__name:"task",props:{routetype:{}},setup($){const m=$,f=U(),_=L(),S=parseInt(f.params.id),y=q(),t=p({title:"齿轮箱协同设计",status:"待审批",version:"1.0",description:"齿轮箱协同设计，相关设计和验证进行中",responsibleId:"张洪磊",createdAt:new Date,dueDate:new Date(new Date().setDate(new Date().getDate()+7)),attachments:["gearbox_design_specifications_v1_review.pdf","gearbox_design_specifications_v1_review.pdf.docx"]}),x=p(""),r=p(!0);function i(d){return d?new Date(d).toLocaleString():"N/A"}function I(){r.value=!0,setTimeout(()=>{t.value.status="已批准",r.value=!1,y.changeTodoStatus(S,"已批准")},1e3),_.push(`${m.routetype}`)}function D(){r.value=!0,setTimeout(()=>{t.value.status="已拒绝",r.value=!1},1e3),_.push(`${m.routetype}`)}function h(){_.push(`${m.routetype}`)}function C(d){alert(`下载文件: ${d}`)}return E(()=>{setTimeout(()=>{r.value=!1,x.value=t.value.responsibleId||""},500)}),(d,o)=>(n(),a("div",H,[r.value?(n(),a("div",J,o[0]||(o[0]=[e("span",{class:"text-gray-500"},"加载中...",-1)]))):(n(),a("div",K,[e("div",O,[e("h2",Q,l(t.value.title),1),e("span",{class:F([{"bg-green-200 text-green-800":t.value.status==="进行中","bg-blue-200 text-blue-800":t.value.status==="已完成","bg-gray-200 text-gray-800":t.value.status!=="进行中"&&t.value.status!=="已完成"},"text-sm px-3 py-1 rounded-full"])},l(t.value.status),3)]),e("div",W,[o[1]||(o[1]=e("strong",null,"版本:",-1)),b(" "+l(t.value.version),1)]),e("div",X,[o[2]||(o[2]=e("strong",null,"任务描述:",-1)),e("p",Z,l(t.value.description),1)]),e("div",ee,[o[3]||(o[3]=e("strong",null,"负责人:",-1)),e("p",te,l(x.value||"无负责人"),1)]),e("div",se,[e("div",null,[o[4]||(o[4]=e("strong",null,"创建时间:",-1)),b(" "+l(i(t.value.createdAt)),1)]),e("div",null,[o[5]||(o[5]=e("strong",null,"截止时间:",-1)),b(" "+l(i(t.value.dueDate)),1)])]),t.value.attachments&&t.value.attachments.length>0?(n(),a("div",oe,[o[6]||(o[6]=e("strong",null,"附件:",-1)),e("ul",ne,[(n(!0),a(k,null,w(t.value.attachments,c=>(n(),a("li",{key:c},[e("a",{href:"#",onClick:j=>C(c),class:"hover:underline"},l(c),9,ae)]))),128))])])):g("",!0),t.value.status==="待审批"?(n(),a("div",le,[e("div",{class:"flex space-x-4"},[e("button",{onClick:I,class:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition ease-in-out duration-200"}," 审批 "),e("button",{onClick:D,class:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition ease-in-out duration-200"}," 拒绝 "),e("button",{onClick:h,class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition ease-in-out duration-200"}," 取消 ")])])):g("",!0),t.value.status!=="待审批"?(n(),a("button",{key:2,onClick:h,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-4 transition ease-in-out duration-200"}," 返回 ")):g("",!0)]))]))}}),Re=M(ue,[["__scopeId","data-v-56a3eb5e"]]),re={class:"max-w-4xl mx-auto bg-white p-6 rounded-lg shadow-md mt-10"},ie={class:"flex justify-between items-center mb-4 border-b pb-4"},de={class:"text-2xl font-semibold"},ce={class:"mb-4"},ve={class:"mb-4"},pe={class:"text-gray-700 mt-2"},be={class:"mb-4"},ge={class:"mt-2"},me={key:0,class:"break-words"},_e={key:1},xe=["value"],fe={class:"mb-4"},ye={class:"mt-2"},he={key:0,class:"break-words"},ke={key:1},we=["value"],$e={class:"mb-4"},Se={key:0,class:"mb-4"},Ie={class:"list-disc ml-5 mt-2 text-blue-600"},De={href:"#",class:"hover:underline"},Ce={key:1,class:"flex justify-between items-center mt-4 mb-4"},je={class:"flex items-center"},Ae=N({__name:"subtask",props:{routetype:{}},setup($){var j,A,T,B;const m=$,f=U();f.params.type;const _=parseInt(f.params.id),S=G(),y=Y(),t=p(),x=["靳春雷","谢经广","于义春","张洪磊","陈卫","张晓峰"],r=p(((j=t.value)==null?void 0:j.responsibleId)===0?"":String((A=t.value)==null?void 0:A.responsibleId)),i=p(((T=t.value)==null?void 0:T.approverId)===0?"":String((B=t.value)==null?void 0:B.approverId)),I=L();function D(v){return new Date(v).toLocaleString()}function h(v){var u;const s=v.target.files;if(s&&s.length>0){const z=s[0].name;(u=t.value)==null||u.attachments.push(z)}}function C(){t.value&&(t.value.status=V.InProgress)}function d(){t.value&&(t.value.status=V.Rejected)}E(()=>{t.value=S.getSubtask(_),t.value&&(r.value=t.value.responsibleId===0?"":y.getUserById(t.value.approverId),i.value=t.value.approverId===0?"":y.getUserById(t.value.approverId))});const o=v=>{switch(v){case"InProgress":return"进行中";case"AwaitingApproval":return"待审批";case"Completed":return"已完成";case"Pending":return"待处理";case"Rejected":return"已驳回";case"Delayed":return"已延期";case"Expired":default:return"未知状态"}};function c(){I.push(`${m.routetype}`)}return(v,s)=>(n(),a("div",re,[e("div",ie,[e("h2",de,l(t.value.title),1),e("span",{class:F([{"bg-green-200 text-green-800":o(t.value.status)==="进行中","bg-blue-200 text-blue-800":o(t.value.status)==="已完成","bg-gray-200 text-gray-800":o(t.value.status)!=="进行中"&&o(t.value.status)!=="已完成"},"text-sm px-3 py-1 rounded-full"])},l(o(t.value.status)),3)]),e("div",ce,[s[2]||(s[2]=e("strong",null,"版本:",-1)),b(" "+l(t.value.version),1)]),e("div",ve,[s[3]||(s[3]=e("strong",null,"项目描述:",-1)),e("p",pe,l(t.value.description),1)]),e("div",be,[s[4]||(s[4]=e("strong",null,"负责人:",-1)),e("div",ge,[r.value&&r.value!=="0"?(n(),a("p",me,l(r.value),1)):(n(),a("p",_e,[P(e("select",{"onUpdate:modelValue":s[0]||(s[0]=u=>r.value=u),class:"block bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm"},[(n(),a(k,null,w(x,u=>e("option",{key:u,value:u},l(u),9,xe)),64))],512),[[R,r.value]])]))])]),e("div",fe,[s[5]||(s[5]=e("strong",null,"审批人:",-1)),e("div",ye,[i.value&&i.value!=="0"?(n(),a("p",he,l(i.value),1)):(n(),a("p",ke,[P(e("select",{"onUpdate:modelValue":s[1]||(s[1]=u=>i.value=u),class:"block bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-sm"},[(n(),a(k,null,w(x,u=>e("option",{key:u,value:u},l(u),9,we)),64))],512),[[R,i.value]])]))])]),e("div",$e,[e("div",null,[s[6]||(s[6]=e("strong",null,"创建时间:",-1)),b(" "+l(t.value.createdAt),1)]),e("div",null,[s[7]||(s[7]=e("strong",null,"截止时间:",-1)),b(" "+l(D(t.value.dueDate)),1)])]),t.value.attachments&&t.value.attachments.length>0?(n(),a("div",Se,[s[8]||(s[8]=e("strong",null,"附件:",-1)),e("ul",Ie,[(n(!0),a(k,null,w(t.value.attachments,u=>(n(),a("li",{key:u},[e("a",De,l(u),1)]))),128))])])):g("",!0),o(t.value.status)==="待处理"?(n(),a("div",Ce,[e("div",je,[s[9]||(s[9]=e("strong",{class:"mr-2"},"上传附件:",-1)),e("input",{type:"file",onChange:h,class:"mr-4"},null,32)]),e("div",{class:"flex space-x-4"},[e("button",{onClick:C,class:"bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition ease-in-out duration-200"}," 审批 "),e("button",{onClick:d,class:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition ease-in-out duration-200"}," 拒绝 "),e("button",{onClick:c,class:"bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition ease-in-out duration-200"}," 取消 ")])])):g("",!0),o(t.value.status)!=="待处理"?(n(),a("button",{key:2,onClick:c,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-4 transition ease-in-out duration-200"}," 返回 ")):g("",!0)]))}}),Ve=M(Ae,[["__scopeId","data-v-88160c8b"]]);export{Re as _,Ve as a};
